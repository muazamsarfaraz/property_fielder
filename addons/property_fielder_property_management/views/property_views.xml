<?xml version='1.0' encoding='utf-8'?>
<odoo>
    <data>
        
        <!-- Property Tree View -->
        <record id="view_property_tree" model="ir.ui.view">
            <field name="name">property_fielder.property.tree</field>
            <field name="model">property_fielder.property</field>
            <field name="arch" type="xml">
                <list string="Properties" decoration-danger="compliance_status == 'expired'" decoration-warning="compliance_status == 'expiring_soon'" decoration-success="compliance_status == 'compliant'">
                    <field name="property_number"/>
                    <field name="name"/>
                    <field name="property_type"/>
                    <field name="city"/>
                    <field name="zip"/>
                    <field name="partner_id"/>
                    <field name="tenant_id"/>
                    <field name="epc_rating" widget="badge" optional="hide"/>
                    <field name="hmo_status" widget="badge" optional="hide"/>
                    <field name="state" widget="badge"/>
                    <field name="compliance_status" widget="badge" decoration-success="compliance_status == 'compliant'" decoration-warning="compliance_status == 'expiring_soon'" decoration-danger="compliance_status in ['expired', 'non_compliant']"/>
                    <field name="flage_fire_status" widget="badge"/>
                    <field name="flage_gas_status" widget="badge"/>
                    <field name="flage_electrical_status" widget="badge"/>
                </list>
            </field>
        </record>
        
        <!-- Property Form View -->
        <record id="view_property_form" model="ir.ui.view">
            <field name="name">property_fielder.property.form</field>
            <field name="model">property_fielder.property</field>
            <field name="arch" type="xml">
                <form string="Property">
                    <header>
                        <field name="state" widget="statusbar" statusbar_visible="draft,active,vacant"/>
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button name="%(action_property_certification)d" type="action" class="oe_stat_button" icon="fa-certificate" context="{'default_property_id': id}">
                                <div class="o_stat_info">
                                    <field name="certification_count" class="o_stat_value"/>
                                    <span class="o_stat_text">Certificates</span>
                                </div>
                            </button>
                            <button name="%(action_property_inspection)d" type="action" class="oe_stat_button" icon="fa-clipboard-check" context="{'default_property_id': id}">
                                <div class="o_stat_info">
                                    <field name="inspection_count" class="o_stat_value"/>
                                    <span class="o_stat_text">Inspections</span>
                                </div>
                            </button>
                            <button name="%(action_property_certification)d" type="action" class="oe_stat_button" icon="fa-exclamation-triangle" invisible="expired_certification_count == 0" context="{'default_property_id': id, 'search_default_expired': 1}">
                                <div class="o_stat_info">
                                    <field name="expired_certification_count" class="o_stat_value text-danger"/>
                                    <span class="o_stat_text">Expired</span>
                                </div>
                            </button>
                            <button class="oe_stat_button" icon="fa-camera" type="object" name="action_view_images">
                                <div class="o_stat_info">
                                    <field name="image_count" class="o_stat_value"/>
                                    <span class="o_stat_text">Photos</span>
                                </div>
                            </button>
                            <button class="oe_stat_button" icon="fa-file-text-o" type="object" name="action_view_documents">
                                <div class="o_stat_info">
                                    <field name="document_count" class="o_stat_value"/>
                                    <span class="o_stat_text">Documents</span>
                                </div>
                            </button>
                            <button class="oe_stat_button" icon="fa-key" type="object" name="action_view_key_sets">
                                <div class="o_stat_info">
                                    <field name="key_set_count" class="o_stat_value"/>
                                    <span class="o_stat_text">Keys</span>
                                </div>
                            </button>
                            <button class="oe_stat_button" icon="fa-tachometer" type="object" name="action_view_utility_meters">
                                <div class="o_stat_info">
                                    <field name="utility_meter_count" class="o_stat_value"/>
                                    <span class="o_stat_text">Meters</span>
                                </div>
                            </button>
                            <button class="oe_stat_button" icon="fa-shield" type="object" name="action_view_insurance">
                                <div class="o_stat_info">
                                    <field name="insurance_count" class="o_stat_value"/>
                                    <span class="o_stat_text">Insurance</span>
                                </div>
                            </button>
                            <button class="oe_stat_button" icon="fa-cogs" type="object" name="action_view_assets">
                                <div class="o_stat_info">
                                    <field name="asset_count" class="o_stat_value"/>
                                    <span class="o_stat_text">Assets</span>
                                </div>
                            </button>
                            <button class="oe_stat_button" icon="fa-bed" type="object" name="action_view_hmo_rooms" invisible="hmo_status == 'not_hmo'">
                                <div class="o_stat_info">
                                    <field name="hmo_room_count" class="o_stat_value"/>
                                    <span class="o_stat_text">Rooms</span>
                                </div>
                            </button>
                        </div>

                        <field name="image" widget="image" class="oe_avatar" options="{'preview_image': 'image_medium'}"/>

                        <div class="oe_title">
                            <h1>
                                <field name="property_number" readonly="1"/>
                            </h1>
                            <label for="name"/>
                            <h2>
                                <field name="name" placeholder="Property Name"/>
                            </h2>
                        </div>
                        
                        <group>
                            <group name="property_info" string="Property Information">
                                <field name="property_type"/>
                                <field name="bedrooms"/>
                                <field name="bathrooms"/>
                                <field name="reception_rooms"/>
                                <field name="floor_area"/>
                                <field name="number_of_floors"/>
                                <field name="year_built"/>
                                <field name="tenure"/>
                                <field name="furnishing_state"/>
                            </group>
                            <group name="ownership" string="Ownership &amp; Hierarchy">
                                <field name="partner_id"/>
                                <field name="tenant_id"/>
                                <field name="parent_id" options="{'no_create': True}"/>
                                <field name="unit_number" invisible="not parent_id"/>
                                <field name="floor_level" invisible="not parent_id"/>
                                <field name="is_block" readonly="1" invisible="not is_block"/>
                                <field name="unit_count" invisible="not is_block"/>
                            </group>
                        </group>

                        <group>
                            <group name="uk_identifiers" string="UK Identifiers">
                                <field name="uprn" placeholder="12 digit UPRN"/>
                                <field name="council_tax_band"/>
                                <field name="council_tax_account"/>
                            </group>
                            <group name="epc_info" string="Energy Performance (EPC)">
                                <field name="epc_rating"/>
                                <field name="epc_score"/>
                                <field name="epc_certificate_number"/>
                                <field name="epc_valid_until"/>
                                <field name="epc_exempt"/>
                                <field name="epc_exempt_reason" invisible="not epc_exempt"/>
                                <field name="mees_compliant" widget="boolean_toggle" readonly="1"/>
                            </group>
                        </group>

                        <group>
                            <group name="building_details" string="Building Details">
                                <field name="construction_type"/>
                                <field name="heating_type"/>
                            </group>
                            <group name="exterior_features" string="Exterior Features">
                                <field name="has_garden"/>
                                <field name="garden_type" invisible="not has_garden"/>
                                <field name="has_parking"/>
                                <field name="parking_type" invisible="not has_parking"/>
                                <field name="parking_spaces" invisible="not has_parking"/>
                            </group>
                        </group>

                        <group name="hmo_section" invisible="hmo_status == 'not_hmo'">
                            <group name="hmo_info" string="HMO Details">
                                <field name="hmo_status"/>
                                <field name="hmo_license_number"/>
                                <field name="hmo_license_expiry"/>
                                <field name="hmo_max_occupancy"/>
                                <field name="hmo_license_holder_id"/>
                            </group>
                            <group name="selective_license" string="Selective Licensing">
                                <field name="selective_license_required"/>
                                <field name="selective_license_number" invisible="not selective_license_required"/>
                                <field name="selective_license_expiry" invisible="not selective_license_required"/>
                            </group>
                        </group>

                        <group invisible="hmo_status != 'not_hmo'">
                            <group name="hmo_status_only">
                                <field name="hmo_status"/>
                            </group>
                            <group/>
                        </group>

                        <div class="alert alert-warning" role="alert" invisible="not section_21_banned">
                            <i class="fa fa-exclamation-triangle"/> <strong>Section 21 Restricted:</strong>
                            This property cannot serve Section 21 notices due to missing compliance requirements.
                        </div>
                        <field name="section_21_banned" invisible="1"/>
                        
                        <group>
                            <group name="address" string="Address">
                                <field name="street"/>
                                <field name="street2"/>
                                <field name="city"/>
                                <field name="state" string="County"/>
                                <field name="zip"/>
                                <field name="country_id"/>
                            </group>
                            <group name="location" string="Location">
                                <!-- Interactive Map Widget -->
                                <div colspan="2" class="mb-3">
                                    <field name="latitude" widget="property_map" nolabel="1"/>
                                </div>
                                <field name="latitude" string="Lat"/>
                                <field name="longitude" string="Lng"/>
                            </group>
                        </group>
                        
                        <!-- NFR-UX-QW7: FLAGE+ Compliance with Traffic Light Indicators -->
                        <group name="compliance" string="FLAGE+ Compliance Status" help="UK regulatory compliance for rental properties: Fire safety, Legionella risk, Asbestos survey, Gas safety (CP12), and Electrical safety (EICR). Green = Valid, Amber = Expiring within 30 days, Red = Expired or Missing.">
                            <group>
                                <label for="flage_fire_status" string="Fire Safety"/>
                                <div class="d-flex align-items-center gap-2">
                                    <span class="flage-icon fire" title="Fire Safety Certificate">F</span>
                                    <field name="flage_fire_status" widget="badge" nolabel="1"/>
                                    <span class="text-muted small" invisible="not flage_fire_expiry">Exp: <field name="flage_fire_expiry" nolabel="1"/></span>
                                </div>
                                <label for="flage_legionella_status" string="Legionella"/>
                                <div class="d-flex align-items-center gap-2">
                                    <span class="flage-icon legionella" title="Legionella Risk Assessment">L</span>
                                    <field name="flage_legionella_status" widget="badge" nolabel="1"/>
                                    <span class="text-muted small" invisible="not flage_legionella_expiry">Exp: <field name="flage_legionella_expiry" nolabel="1"/></span>
                                </div>
                                <label for="flage_asbestos_status" string="Asbestos"/>
                                <div class="d-flex align-items-center gap-2">
                                    <span class="flage-icon asbestos" title="Asbestos Survey">A</span>
                                    <field name="flage_asbestos_status" widget="badge" nolabel="1"/>
                                    <span class="text-muted small" invisible="not flage_asbestos_expiry">Exp: <field name="flage_asbestos_expiry" nolabel="1"/></span>
                                </div>
                            </group>
                            <group>
                                <label for="flage_gas_status" string="Gas Safety"/>
                                <div class="d-flex align-items-center gap-2">
                                    <span class="flage-icon gas" title="Gas Safety Certificate (CP12)">G</span>
                                    <field name="flage_gas_status" widget="badge" nolabel="1"/>
                                    <span class="text-muted small" invisible="not flage_gas_expiry">Exp: <field name="flage_gas_expiry" nolabel="1"/></span>
                                </div>
                                <label for="flage_electrical_status" string="Electrical Safety"/>
                                <div class="d-flex align-items-center gap-2">
                                    <span class="flage-icon electrical" title="EICR - Electrical Installation Condition Report">E</span>
                                    <field name="flage_electrical_status" widget="badge" nolabel="1"/>
                                    <span class="text-muted small" invisible="not flage_electrical_expiry">Exp: <field name="flage_electrical_expiry" nolabel="1"/></span>
                                </div>
                                <label for="compliance_status" string="Overall Status"/>
                                <div class="d-flex align-items-center gap-2">
                                    <field name="compliance_status" widget="badge" nolabel="1"/>
                                </div>
                            </group>
                        </group>
                        
                        <notebook>
                            <page string="Certifications" name="certifications">
                                <field name="certification_ids">
                                    <list decoration-danger="status == 'expired'" decoration-warning="status == 'expiring_soon'">
                                        <field name="certification_type_id"/>
                                        <field name="flage_category" widget="badge"/>
                                        <field name="issue_date"/>
                                        <field name="expiry_date"/>
                                        <field name="days_until_expiry"/>
                                        <field name="status" widget="badge"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Inspections" name="inspections">
                                <field name="inspection_ids">
                                    <list>
                                        <field name="name"/>
                                        <field name="certification_type_id"/>
                                        <field name="scheduled_date"/>
                                        <field name="inspector_id"/>
                                        <field name="state" widget="badge"/>
                                        <field name="result" widget="badge"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Photos" name="photos">
                                <div class="alert alert-info mb-3" role="alert">
                                    <strong>ðŸ“· Photo Gallery</strong> - Upload photos of your property.
                                    Click a photo to edit, or mark one as the main image to display on cards.
                                </div>
                                <field name="image_ids" mode="kanban">
                                    <kanban class="pm_photo_gallery">
                                        <field name="id"/>
                                        <field name="name"/>
                                        <field name="image_medium"/>
                                        <field name="category"/>
                                        <field name="is_main"/>
                                        <field name="taken_date"/>
                                        <field name="sequence"/>
                                        <templates>
                                            <t t-name="card">
                                                <div class="pm_gallery_card oe_kanban_global_click">
                                                    <div class="pm_gallery_image_wrapper">
                                                        <field name="image_medium" widget="image" class="pm_gallery_image"/>
                                                        <div class="pm_gallery_overlay">
                                                            <span t-if="record.is_main.raw_value" class="pm_main_badge" title="Main Property Image">â˜…</span>
                                                        </div>
                                                    </div>
                                                    <div class="pm_gallery_info">
                                                        <div class="pm_gallery_title" t-if="record.name.raw_value">
                                                            <field name="name"/>
                                                        </div>
                                                        <div class="pm_gallery_meta">
                                                            <field name="category" widget="badge"/>
                                                            <span t-if="record.taken_date.raw_value" class="pm_gallery_date">
                                                                <field name="taken_date"/>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </templates>
                                    </kanban>
                                </field>
                            </page>
                            <page string="Documents" name="documents">
                                <div class="alert alert-info mb-3" role="alert">
                                    <strong>ðŸ“„ Document Repository</strong> - Store important property documents like leases, insurance policies, floor plans, and certificates.
                                </div>
                                <field name="document_ids" mode="kanban">
                                    <kanban class="o_kanban_small_column">
                                        <field name="id"/>
                                        <field name="name"/>
                                        <field name="category"/>
                                        <field name="document_file"/>
                                        <field name="document_filename"/>
                                        <field name="expiry_date"/>
                                        <field name="is_expired"/>
                                        <field name="is_active"/>
                                        <templates>
                                            <t t-name="card">
                                                <div class="d-flex align-items-center">
                                                    <div class="me-2">
                                                        <i t-if="record.category.raw_value == 'lease'" class="fa fa-file-text-o fa-2x text-primary" title="Lease"/>
                                                        <i t-elif="record.category.raw_value == 'insurance'" class="fa fa-shield fa-2x text-success" title="Insurance"/>
                                                        <i t-elif="record.category.raw_value == 'certificate'" class="fa fa-certificate fa-2x text-warning" title="Certificate"/>
                                                        <i t-elif="record.category.raw_value == 'plan'" class="fa fa-map fa-2x text-info" title="Plan"/>
                                                        <i t-elif="record.category.raw_value == 'inventory'" class="fa fa-list-alt fa-2x text-secondary" title="Inventory"/>
                                                        <i t-elif="record.category.raw_value == 'correspondence'" class="fa fa-envelope fa-2x text-muted" title="Correspondence"/>
                                                        <i t-else="" class="fa fa-file-o fa-2x text-muted" title="Document"/>
                                                    </div>
                                                    <div class="flex-grow-1">
                                                        <strong><field name="name"/></strong>
                                                        <div class="text-muted small">
                                                            <field name="category" widget="badge"/>
                                                        </div>
                                                        <div t-if="record.expiry_date.raw_value" class="small">
                                                            <span t-attf-class="#{record.is_expired.raw_value ? 'text-danger' : ''}">
                                                                Expires: <field name="expiry_date"/>
                                                            </span>
                                                        </div>
                                                    </div>
                                                </div>
                                            </t>
                                        </templates>
                                    </kanban>
                                </field>
                            </page>
                            <page string="Access" name="access">
                                <div class="text-muted mb-3">
                                    <i class="fa fa-key" title="Key"/> Property Access Information - Entry instructions for inspectors and maintenance staff
                                </div>
                                <group>
                                    <group name="key_access" string="Key Access">
                                        <field name="key_safe_location" placeholder="e.g., Left side of front door"/>
                                        <field name="key_safe_code" password="True" placeholder="Enter code"/>
                                        <field name="entry_instructions" placeholder="Special entry instructions..."/>
                                    </group>
                                    <group name="contact_hours" string="Contact &amp; Hours">
                                        <field name="access_contact_id"/>
                                        <field name="access_contact_phone"/>
                                        <field name="access_hours" placeholder="e.g., 9am-5pm weekdays"/>
                                    </group>
                                </group>
                                <group>
                                    <group name="parking" string="Parking">
                                        <field name="parking_instructions" placeholder="Where to park when visiting..."/>
                                    </group>
                                    <group name="access_notes" string="Additional Notes">
                                        <field name="access_notes" placeholder="Dogs, alarms, special requirements..."/>
                                    </group>
                                </group>
                            </page>
                            <page string="Keys" name="keys">
                                <field name="key_set_ids">
                                    <list>
                                        <field name="name"/>
                                        <field name="key_type"/>
                                        <field name="key_count"/>
                                        <field name="fob_count"/>
                                        <field name="holder_id"/>
                                        <field name="holder_type"/>
                                        <field name="state" widget="badge"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Meters" name="meters">
                                <field name="utility_meter_ids">
                                    <list>
                                        <field name="utility_type"/>
                                        <field name="meter_serial"/>
                                        <field name="mpan"/>
                                        <field name="mprn"/>
                                        <field name="supplier_id"/>
                                        <field name="last_reading"/>
                                        <field name="last_reading_date"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Insurance" name="insurance">
                                <field name="insurance_ids">
                                    <list decoration-danger="status == 'expired'" decoration-warning="status == 'expiring'">
                                        <field name="policy_number"/>
                                        <field name="policy_type"/>
                                        <field name="insurer_name"/>
                                        <field name="start_date"/>
                                        <field name="expiry_date"/>
                                        <field name="annual_premium"/>
                                        <field name="status" widget="badge"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Assets" name="assets">
                                <field name="asset_ids">
                                    <list>
                                        <field name="name"/>
                                        <field name="asset_type"/>
                                        <field name="asset_category"/>
                                        <field name="location"/>
                                        <field name="manufacturer"/>
                                        <field name="state" widget="badge"/>
                                        <field name="next_service_date"/>
                                    </list>
                                </field>
                            </page>
                            <page string="HMO Rooms" name="hmo_rooms" invisible="hmo_status == 'not_hmo'">
                                <field name="hmo_room_ids">
                                    <list decoration-danger="not compliant">
                                        <field name="room_number"/>
                                        <field name="room_type"/>
                                        <field name="floor_level"/>
                                        <field name="floor_area_sqm"/>
                                        <field name="max_occupancy"/>
                                        <field name="current_occupancy"/>
                                        <field name="tenant_id"/>
                                        <field name="compliant" widget="boolean"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Units" name="units" invisible="not is_block">
                                <field name="child_ids">
                                    <list>
                                        <field name="property_number"/>
                                        <field name="name"/>
                                        <field name="unit_number"/>
                                        <field name="floor_level"/>
                                        <field name="tenant_id"/>
                                        <field name="compliance_status" widget="badge"/>
                                    </list>
                                </field>
                            </page>
                            <page string="Notes" name="notes">
                                <field name="notes" placeholder="Additional notes about this property..."/>
                            </page>
                        </notebook>
                    </sheet>
                    <div class="oe_chatter">
                        <field name="message_follower_ids"/>
                        <field name="activity_ids"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>
        </record>
        
        <!-- Property Kanban View -->
        <record id="view_property_kanban" model="ir.ui.view">
            <field name="name">property_fielder.property.kanban</field>
            <field name="model">property_fielder.property</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_small_column pm_property_kanban">
                    <field name="id"/>
                    <field name="property_number"/>
                    <field name="name"/>
                    <field name="property_type"/>
                    <field name="city"/>
                    <field name="image_small"/>
                    <field name="compliance_status"/>
                    <field name="next_inspection_date"/>
                    <field name="next_inspection_type"/>
                    <field name="flage_fire_status"/>
                    <field name="flage_legionella_status"/>
                    <field name="flage_asbestos_status"/>
                    <field name="flage_gas_status"/>
                    <field name="flage_electrical_status"/>
                    <templates>
                        <t t-name="card">
                            <div class="oe_kanban_global_click">
                                <!-- Header with Image and Compliance Badge -->
                                <div class="d-flex align-items-start mb-2">
                                    <div class="o_kanban_image me-2 flex-shrink-0">
                                        <t t-if="record.image_small.raw_value">
                                            <field name="image_small" widget="image" options="{'size': [80, 80]}"/>
                                        </t>
                                        <t t-else="">
                                            <div class="o_kanban_image_default d-flex align-items-center justify-content-center bg-light rounded" style="width:80px;height:80px;">
                                                <i class="fa fa-building fa-2x text-muted"/>
                                            </div>
                                        </t>
                                    </div>
                                    <div class="o_kanban_details flex-grow-1">
                                        <div class="o_kanban_record_top mb-1 d-flex justify-content-between align-items-start">
                                            <strong class="text-truncate me-1"><field name="property_number"/> - <field name="name"/></strong>
                                            <!-- Color-coded Compliance Badge -->
                                            <span t-attf-class="badge flex-shrink-0 #{record.compliance_status.raw_value == 'compliant' ? 'text-bg-success' : (record.compliance_status.raw_value == 'expiring_soon' ? 'text-bg-warning' : (record.compliance_status.raw_value == 'expired' ? 'text-bg-danger' : 'text-bg-danger'))}">
                                                <t t-if="record.compliance_status.raw_value == 'compliant'"><i class="fa fa-check-circle"/> OK</t>
                                                <t t-elif="record.compliance_status.raw_value == 'expiring_soon'"><i class="fa fa-clock-o"/> Expiring</t>
                                                <t t-elif="record.compliance_status.raw_value == 'expired'"><i class="fa fa-exclamation-circle"/> Expired</t>
                                                <t t-else=""><i class="fa fa-times-circle"/> Non-Compliant</t>
                                            </span>
                                        </div>
                                        <div class="o_kanban_record_body text-muted small">
                                            <div><field name="property_type"/> â€¢ <field name="city"/></div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Next Inspection Date -->
                                <div t-if="record.next_inspection_date.raw_value" class="small mb-2 text-primary">
                                    <i class="fa fa-calendar"/> Next: <field name="next_inspection_type"/> - <field name="next_inspection_date"/>
                                </div>

                                <!-- FLAGE+ Status Icons -->
                                <div class="o_kanban_record_bottom">
                                    <div class="d-flex gap-1 flex-wrap" title="FLAGE+ Compliance Status">
                                        <span t-attf-class="badge #{record.flage_fire_status.raw_value == 'valid' ? 'text-bg-success' : (record.flage_fire_status.raw_value == 'expiring' ? 'text-bg-warning' : (record.flage_fire_status.raw_value == 'expired' ? 'text-bg-danger' : 'text-bg-secondary'))}" title="Fire Safety">F</span>
                                        <span t-attf-class="badge #{record.flage_legionella_status.raw_value == 'valid' ? 'text-bg-success' : (record.flage_legionella_status.raw_value == 'expiring' ? 'text-bg-warning' : (record.flage_legionella_status.raw_value == 'expired' ? 'text-bg-danger' : 'text-bg-secondary'))}" title="Legionella">L</span>
                                        <span t-attf-class="badge #{record.flage_asbestos_status.raw_value == 'valid' ? 'text-bg-success' : (record.flage_asbestos_status.raw_value == 'expiring' ? 'text-bg-warning' : (record.flage_asbestos_status.raw_value == 'expired' ? 'text-bg-danger' : 'text-bg-secondary'))}" title="Asbestos">A</span>
                                        <span t-attf-class="badge #{record.flage_gas_status.raw_value == 'valid' ? 'text-bg-success' : (record.flage_gas_status.raw_value == 'expiring' ? 'text-bg-warning' : (record.flage_gas_status.raw_value == 'expired' ? 'text-bg-danger' : 'text-bg-secondary'))}" title="Gas Safety">G</span>
                                        <span t-attf-class="badge #{record.flage_electrical_status.raw_value == 'valid' ? 'text-bg-success' : (record.flage_electrical_status.raw_value == 'expiring' ? 'text-bg-warning' : (record.flage_electrical_status.raw_value == 'expired' ? 'text-bg-danger' : 'text-bg-secondary'))}" title="Electrical Safety">E</span>
                                    </div>
                                </div>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>
        
        <!-- Property Search View -->
        <record id="view_property_search" model="ir.ui.view">
            <field name="name">property_fielder.property.search</field>
            <field name="model">property_fielder.property</field>
            <field name="arch" type="xml">
                <search string="Properties">
                    <field name="name"/>
                    <field name="property_number"/>
                    <field name="uprn"/>
                    <field name="city"/>
                    <field name="zip"/>
                    <field name="partner_id"/>
                    <field name="tenant_id"/>
                    <!-- Property Status Filters -->
                    <filter string="Active" name="active" domain="[('state', '=', 'active')]"/>
                    <filter string="Vacant" name="vacant" domain="[('state', '=', 'vacant')]"/>
                    <separator/>
                    <!-- NFR-UX-QW6: Enhanced Compliance Filters -->
                    <filter string="Compliant" name="compliant" domain="[('compliance_status', '=', 'compliant')]"/>
                    <filter string="Expiring Soon" name="expiring_soon" domain="[('compliance_status', '=', 'expiring_soon')]"/>
                    <filter string="Expired" name="expired" domain="[('compliance_status', '=', 'expired')]"/>
                    <filter string="Non-Compliant" name="non_compliant" domain="[('compliance_status', '=', 'non_compliant')]"/>
                    <separator/>
                    <!-- FLAGE+ Individual Category Filters -->
                    <filter string="Fire Expired" name="fire_expired" domain="[('flage_fire_status', '=', 'expired')]"/>
                    <filter string="Legionella Expired" name="legionella_expired" domain="[('flage_legionella_status', '=', 'expired')]"/>
                    <filter string="Asbestos Expired" name="asbestos_expired" domain="[('flage_asbestos_status', '=', 'expired')]"/>
                    <filter string="Gas Expired" name="gas_expired" domain="[('flage_gas_status', '=', 'expired')]"/>
                    <filter string="Electrical Expired" name="electrical_expired" domain="[('flage_electrical_status', '=', 'expired')]"/>
                    <separator/>
                    <!-- Inspection Due Filters (for job creation workflow) -->
                    <filter string="Inspections Due (14 days)" name="due_14_days" domain="['|', '|', '|', '|', ('flage_fire_status', '=', 'expiring'), ('flage_legionella_status', '=', 'expiring'), ('flage_asbestos_status', '=', 'expiring'), ('flage_gas_status', '=', 'expiring'), ('flage_electrical_status', '=', 'expiring')]"/>
                    <filter string="Any Cert Expiring" name="any_expiring" domain="['|', '|', '|', '|', ('flage_fire_status', 'in', ['expiring', 'expired']), ('flage_legionella_status', 'in', ['expiring', 'expired']), ('flage_asbestos_status', 'in', ['expiring', 'expired']), ('flage_gas_status', 'in', ['expiring', 'expired']), ('flage_electrical_status', 'in', ['expiring', 'expired'])]"/>
                    <separator/>
                    <!-- HMO and Regulatory Filters -->
                    <filter string="HMO Properties" name="hmo" domain="[('hmo_status', '!=', 'not_hmo')]"/>
                    <filter string="Licensed HMO" name="hmo_licensed" domain="[('hmo_status', '=', 'licensed')]"/>
                    <filter string="MEES Non-Compliant" name="mees_fail" domain="[('mees_compliant', '=', False)]"/>
                    <filter string="Section 21 Banned" name="s21_banned" domain="[('section_21_banned', '=', True)]"/>
                    <separator/>
                    <!-- Property Features Filters -->
                    <filter string="Has Garden" name="has_garden" domain="[('has_garden', '=', True)]"/>
                    <filter string="Has Parking" name="has_parking" domain="[('has_parking', '=', True)]"/>
                    <separator/>
                    <!-- Group By Filters -->
                    <filter string="Property Type" name="group_property_type" context="{'group_by': 'property_type'}"/>
                    <filter string="City" name="group_city" context="{'group_by': 'city'}"/>
                    <filter string="Owner" name="group_owner" context="{'group_by': 'partner_id'}"/>
                    <filter string="Compliance Status" name="group_compliance" context="{'group_by': 'compliance_status'}"/>
                    <filter string="EPC Rating" name="group_epc" context="{'group_by': 'epc_rating'}"/>
                    <filter string="HMO Status" name="group_hmo" context="{'group_by': 'hmo_status'}"/>
                    <filter string="Council Tax Band" name="group_council_tax" context="{'group_by': 'council_tax_band'}"/>
                    <filter string="Construction Type" name="group_construction" context="{'group_by': 'construction_type'}"/>
                    <filter string="Heating Type" name="group_heating" context="{'group_by': 'heating_type'}"/>
                </search>
            </field>
        </record>

    </data>
</odoo>